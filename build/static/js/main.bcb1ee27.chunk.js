(this["webpackJsonptest-timers"]=this["webpackJsonptest-timers"]||[]).push([[0],{38:function(e,t,n){},39:function(e,t,n){},65:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),a=n(33),i=n.n(a),r=n(12),o=(n(38),n(39),n(40),n(2)),l=n(3),u=function(e){return JSON.parse(window.localStorage.getItem(e))||j[e]},j={pxWidth:1366,cmWidth:41,boxes:10,size:[7,2],time:{ready:15,alarm:19,limit:20}},d={pxWidth:u("pxWidth"),setPxWidth:Object(l.b)((function(e,t){e.pxWidth=t})),cmWidth:u("cmWidth"),setCmWidth:Object(l.b)((function(e,t){e.cmWidth=t})),boxes:u("boxes"),setBoxes:Object(l.b)((function(e,t){e.boxes=t})),size:u("size"),setSize:Object(l.b)((function(e,t){e.size=t})),time:u("time"),setTime:Object(l.b)((function(e,t){e.time=t})),clock:Date(),setClock:Object(l.b)((function(e,t){e.clock=t})),network:!1,setNetwork:Object(l.b)((function(e,t){e.network=t}))},b=n(4),O=n(19),f=n(6),m=n.n(f),h=n(10),x=n(11),v=n.n(x),p="http://".concat(window.location.hostname,":9999"),g="http://".concat(window.location.hostname,":10000"),N=function(){var e=Object(h.a)(m.a.mark((function e(t,n,c,s,a){var i,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={id:c,barcode:t,result:n,start:s,end:a},console.log("... sending results:",i),r="".concat(g,"/result"),e.next=5,v.a.post(r,{barcode:t,result:n,id:c});case 5:return o=e.sent,e.abrupt("return",o.data);case 7:case"end":return e.stop()}}),e)})));return function(t,n,c,s,a){return e.apply(this,arguments)}}(),w=function(){var e=Object(h.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... getting events"),t="".concat(p,"/network/scan"),e.next=4,v.a.get(t);case 4:return n=e.sent,e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(h.a)(m.a.mark((function e(t,n){var c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... configure wifi"),c="".concat(p,"/network/save"),e.next=4,v.a.post(c,{ssid:t,pass:n});case 4:return s=e.sent,e.abrupt("return",s.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y=function(){var e=Object(h.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... get device ID"),t="".concat(p,"/device/id"),e.next=4,v.a.get(t);case 4:return n=e.sent,console.log(n.data),e.abrupt("return",n.data);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(h.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... get git commit"),t="".concat(p,"/git/commit"),e.next=4,v.a.get(t);case 4:return n=e.sent,e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=n(13),W=n(14),I=n(0),E=function(e){var t=e.to;return Object(I.jsx)(r.b,{to:t,className:"navigator",children:"/home"===t?Object(I.jsx)(C.a,{icon:W.a}):Object(I.jsx)(C.a,{icon:W.c})})},D=n.p+"static/media/beep.94ec08ca.mp3",z=function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},A=new Audio(D),F=function(e){var t=e.test,n=e.setReady,s=e.setFree,a=t.id,i=t.barcode,r=Object(c.useState)(0),o=Object(b.a)(r,2),u=o[0],j=o[1],d=Object(c.useState)("free"),O=Object(b.a)(d,2),f=O[0],m=O[1],h=Object(l.e)((function(e){return e.size})),x=Object(l.e)((function(e){return e.pxWidth})),v=Object(l.e)((function(e){return e.cmWidth})),p=Object(l.e)((function(e){return e.clock})),g=Object(l.e)((function(e){return e.time})),N=g.ready,w=g.limit,k=g.alarm,y=x/v,S=[parseInt(h[0]*y),parseInt(h[1]*y)],C={height:S[1],width:S[0],minHeight:S[1],minWidth:S[0]},W=function(){m("counting")},E=function(){m("free"),j(0),n(a,!1),s(a)};return Object(c.useEffect)((function(){"free"!==f&&j(u+1),u>=N&&(m("finished"),n(a,!0)),u>=w&&m("overtime"),u>=k&&A.play()}),[p]),Object(c.useEffect)((function(){null!==i?W():E()}),[i]),Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)("div",{className:"out-box animate__animated has-background-".concat(("free"===f?"success":"counting"===f&&"warning")||"finished"===f&&"danger"||"overtime"===f&&"danger"," ").concat("overtime"===f&&"animate__flash animate__infinite"),children:[Object(I.jsxs)("div",{className:"is-flex is-flex-centered has-background-black is-flex-column",style:C,children:[Object(I.jsx)("p",{className:"help is-success box-code is-size-4",children:i}),Object(I.jsxs)("div",{className:"field is-grouped",children:[Object(I.jsx)("button",{className:"button m-1 is-small is-rounded",onClick:W,children:">"}),Object(I.jsx)("button",{className:"button m-1 is-small is-rounded",onClick:E,children:"[]"}),Object(I.jsx)("button",{className:"button m-1 is-small is-rounded",children:u})]})]}),Object(I.jsx)("progress",{className:"progress is-info mt-2",max:N,value:u})]})})},L=function(e){var t=e.handleNegative,n=e.handlePositive,c=e.handleInvalid;return Object(I.jsxs)("div",{className:"field is-grouped mt-4",children:[Object(I.jsx)("button",{onClick:t,className:"button is-large is-outlined is-success",children:"Negative"}),Object(I.jsx)("button",{onClick:n,className:"button is-large ml-4 is-outlined is-danger",children:"Positive"}),Object(I.jsx)("button",{onClick:c,className:"button is-large ml-4 is-outlined is-warning",children:"Invalid"})]})},P=function(){var e=Object(l.e)((function(e){return e.network}));return Object(I.jsx)(r.b,{to:"/wifi",className:"wifi",children:Object(I.jsx)(C.a,{icon:W.d,className:e?"has-text-success":"has-text-grey"})})},R=function(){var e=Object(l.e)((function(e){return e.boxes})),t=Object(l.e)((function(e){return e.clock})),n=Object(l.d)((function(e){return e.setClock})),s=Object(l.d)((function(e){return e.setNetwork})),a=Object(O.a)(Array(parseInt(e)).keys()),i=[];a.forEach((function(e){i.push({id:e,barcode:null,ready:!1,start:null})}));var r=Object(c.useState)(""),o=Object(b.a)(r,2),u=o[0],j=o[1],d=Object(c.useState)(""),f=Object(b.a)(d,2),m=f[0],h=f[1],x=Object(c.useState)("Scan a test"),v=Object(b.a)(x,2),p=v[0],g=v[1],w=Object(c.useState)(""),k=Object(b.a)(w,2),S=k[0],C=k[1],W=Object(c.useState)(!1),D=Object(b.a)(W,2),z=D[0],A=D[1],R=Object(c.useState)(Date.now()),T=Object(b.a)(R,2),_=T[0],J=T[1],B=Object(c.useState)(i),H=Object(b.a)(B,2),M=H[0],V=H[1],q=Object(c.useState)(""),G=Object(b.a)(q,2),K=G[0],Q=G[1],U=function(e,t){Object(O.a)(M)[e].ready=t},X=function(e){var t=Object(O.a)(M);t[e].barcode=null,V(t)},Y=function(){A(!1),g(""),console.log(S);var e=M.find((function(e){return e.barcode===S}));X(e.id),U(e.id,!1);var t=Date.now();return{start:e.start,end:t}};return Object(c.useEffect)((function(){var e=Date.now();h("".concat(e-_>500?"":m).concat(u)),J(e)}),[u]),Object(c.useEffect)((function(){if(Date.now()-_>500&&""!==m){C(m);var e=Object(O.a)(M),t=e.map((function(e){return e.barcode})),n=t.indexOf(null);if(!t.includes(m))A(!1),n>=0?(M[n].barcode=m,M[n].start=Date.now(),g("Starting timer for test: "+m)):g("No box available for: "+m);else M.find((function(e){return e.barcode===m})).ready?(g("Test ".concat(m," is ready, select an option:")),A(!0)):g("Test ".concat(m," is not ready"));V(e),h("")}}),[t]),Object(c.useEffect)((function(){y().then((function(e){return Q(e.id)}));var e=function(e){1===e.key.length&&j(e.key),"F5"===e.key&&e.preventDefault()},t=setInterval((function(){n(Date())}),500);return document.addEventListener("keydown",e),window.addEventListener("offline",(function(){return s(!1)})),window.addEventListener("online",(function(){return s(!0)})),s(window.navigator.onLine),function(){document.removeEventListener("keydown",e),window.removeEventListener("offline",(function(){return s(!1)})),window.removeEventListener("online",(function(){return s(!0)})),clearInterval(t)}}),[]),Object(I.jsxs)("div",{className:"home-container",children:[Object(I.jsxs)("header",{children:[Object(I.jsx)("p",{className:"has-text-centered title mt-4",children:p}),z&&Object(I.jsx)(L,{handleNegative:function(){var e=Y(),t=e.start,n=e.end;N(S,"negative",K,t,n)},handlePositive:function(){var e=Y(),t=e.start,n=e.end;N(S,"positive",K,t,n)},handleInvalid:function(){var e=Y(),t=e.start,n=e.end;N(S,"invalid",K,t,n)}})]}),Object(I.jsxs)("div",{className:"box-container",children:[M.map((function(e){return Object(I.jsx)(F,{test:e,setReady:U,setFree:X},e.id)})),Object(I.jsx)(E,{to:"/config",onClick:function(){return console.log("Clicked Navigator")}}),Object(I.jsx)(P,{})]})]})},T=n(15),_=function(e){var t=e.active,n=e.setActive,c=e.title,s=e.confirm,a=e.setAction;return Object(I.jsxs)("div",{className:"modal ".concat(t&&"is-active"),children:[Object(I.jsx)("div",{className:"modal-background"}),Object(I.jsxs)("div",{className:"modal-card",children:[Object(I.jsx)("header",{className:"modal-card-head",children:Object(I.jsx)("p",{className:"modal-card-title",children:c})}),Object(I.jsxs)("footer",{className:"modal-card-foot is-flex-end",children:[Object(I.jsx)("button",{className:"button is-success is-outlined",onClick:function(){return a()},children:s}),Object(I.jsx)("button",{className:"button",onClick:function(){return n(!1)},children:"Cancel"})]})]})]})},J=function(){var e=Object(o.f)(),t=Object(c.useState)(""),n=Object(b.a)(t,2),s=n[0],a=n[1],i=Object(c.useState)(!1),r=Object(b.a)(i,2),u=r[0],j=r[1],d=Object(c.useState)(!1),O=Object(b.a)(d,2),f=O[0],m=O[1],h=Object(c.useState)(""),x=Object(b.a)(h,2),v=x[0],p=x[1],g=Object(c.useState)(""),N=Object(b.a)(g,2),w=N[0],k=N[1],D=Object(l.e)((function(e){return e.pxWidth})),A=Object(l.e)((function(e){return e.cmWidth})),F=Object(l.e)((function(e){return e.boxes})),L=Object(l.e)((function(e){return e.size})),P=Object(l.e)((function(e){return e.time})),R=Object(l.d)((function(e){return e.setPxWidth})),J=Object(l.d)((function(e){return e.setCmWidth})),B=Object(l.d)((function(e){return e.setBoxes})),H=Object(l.d)((function(e){return e.setSize})),M=Object(l.d)((function(e){return e.setTime})),V=Object(c.useState)(D),q=Object(b.a)(V,2),G=q[0],K=q[1],Q=Object(c.useState)(A),U=Object(b.a)(Q,2),X=U[0],Y=U[1],Z=Object(c.useState)(F),$=Object(b.a)(Z,2),ee=$[0],te=$[1],ne=Object(c.useState)(L),ce=Object(b.a)(ne,2),se=ce[0],ae=ce[1],ie=Object(c.useState)(P),re=Object(b.a)(ie,2),oe=re[0],le=re[1];return Object(c.useEffect)((function(){y().then((function(e){return p(e.id)})),S().then((function(e){return k(e.commit.date)}))})),Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(E,{to:"/home"}),Object(I.jsx)("div",{className:"is-flex is-flex-centered config",children:Object(I.jsxs)("div",{children:[Object(I.jsx)("h1",{className:"subtitle has-text-centered",children:"Configuration"}),Object(I.jsxs)("div",{className:"field",children:[Object(I.jsx)("label",{className:"label",children:"Number of boxes"}),Object(I.jsx)("div",{className:"control",children:Object(I.jsx)("input",{className:"input",type:"number",placeholder:"10",value:ee,onChange:function(e){return te(e.target.value)}})})]}),Object(I.jsxs)("div",{className:"field",children:[Object(I.jsx)("label",{className:"label",children:"Width of screen in pixels."}),Object(I.jsx)("div",{className:"control",children:Object(I.jsx)("input",{className:"input",type:"number",placeholder:"1366",value:G,onChange:function(e){return K(e.target.value)}})})]}),Object(I.jsxs)("div",{className:"field",children:[Object(I.jsx)("label",{className:"label",children:"Width of screen in centimeters."}),Object(I.jsx)("div",{className:"control",children:Object(I.jsx)("input",{className:"input",type:"number",placeholder:"41",value:X,onChange:function(e){return Y(e.target.value)}})})]}),Object(I.jsxs)("div",{className:"field",children:[Object(I.jsx)("label",{className:"label",children:"Size of box in cm."}),Object(I.jsxs)("div",{className:"control is-flex",children:[Object(I.jsx)("input",{className:"input",type:"number",placeholder:"7",value:se[0],onChange:function(e){return ae([e.target.value,se[1]])},title:"Width"}),Object(I.jsx)("input",{className:"input ml-4",type:"number",placeholder:"2",value:se[1],onChange:function(e){return ae([se[0],e.target.value])},title:"Height"})]})]}),Object(I.jsxs)("div",{className:"field",children:[Object(I.jsx)("label",{className:"label",children:"Process time in min."}),Object(I.jsxs)("div",{className:"control is-flex",children:[Object(I.jsx)("input",{className:"input",type:"number",placeholder:"15",value:oe.ready,title:"Ready to read time",onChange:function(e){return le(Object(T.a)(Object(T.a)({},oe),{},{ready:e.target.value}))}}),Object(I.jsx)("input",{className:"input ml-4",type:"number",placeholder:"19",value:oe.alarm,title:"Alarm time",onChange:function(e){return le(Object(T.a)(Object(T.a)({},oe),{},{alarm:e.target.value}))}}),Object(I.jsx)("input",{className:"input ml-4",type:"number",placeholder:"20",value:oe.limit,title:"Maximum time to get reading",onChange:function(e){return le(Object(T.a)(Object(T.a)({},oe),{},{limit:e.target.value}))}})]})]}),Object(I.jsx)("button",{onClick:function(){R(G),J(X),B(ee),H(se),M(oe),z("pxWidth",G),z("cmWidth",X),z("boxes",ee),z("size",se),z("time",oe),a(" ... going home"),j(!0),setTimeout((function(){return e("/home")}),1e3)},className:"button is-success is-outlined mt-4 ".concat(u&&"is-loading"),children:"Save"}),Object(I.jsx)("p",{className:"help",children:s}),Object(I.jsxs)("div",{className:"is-flex is-flex-centered m-4 ",children:[Object(I.jsx)(C.a,{icon:W.b,className:"has-text-danger pointer",size:"lg",onClick:function(){return m(!0)}}),Object(I.jsx)(_,{active:f,setActive:m,setAction:function(){console.log("... powering off")},title:"Do you want to shutdown?",confirm:"Shutdown"})]}),Object(I.jsxs)("div",{className:"is-flex mt-4 is-flex-between",children:[Object(I.jsxs)("p",{className:"has-text-grey mt-4",children:["ID: ",v]}),Object(I.jsxs)("p",{className:"has-text-grey mt-4",children:["Version: ",w]})]})]})})]})},B=function(){var e=Object(o.f)(),t=Object(c.useState)(!1),n=Object(b.a)(t,2),s=n[0],a=n[1],i=Object(c.useState)([]),r=Object(b.a)(i,2),l=r[0],u=r[1],j=Object(c.useRef)(),d=Object(c.useRef)();return Object(c.useEffect)((function(){w().then((function(e){return u(e.networks)}))}),[]),Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(E,{to:"/home"}),Object(I.jsx)("div",{className:"is-flex is-flex-centered config",children:Object(I.jsxs)("div",{children:[Object(I.jsx)("h1",{className:"subtitle has-text-centered",children:"Wifi Configuration"}),Object(I.jsxs)("div",{className:"field",children:[Object(I.jsx)("label",{className:"label",children:"SSID"}),Object(I.jsx)("div",{className:"control",children:Object(I.jsx)("input",{className:"input",type:"text",placeholder:"WiFi SSID",ref:j})})]}),Object(I.jsxs)("div",{className:"field",children:[Object(I.jsx)("label",{className:"label",children:"Password"}),Object(I.jsx)("div",{className:"control",children:Object(I.jsx)("input",{className:"input",type:"text",placeholder:"********",ref:d})})]}),Object(I.jsx)("button",{onClick:function(){a(!0),k(j.current.value,d.current.value),setTimeout((function(){return e("/home")}),1e3)},className:"button is-success is-outlined mt-4 ".concat(s&&"is-loading"),children:"Save"}),Object(I.jsx)("p",{className:"help",children:""}),Object(I.jsx)("p",{className:"mt-4 has-text-centered",children:"Available networks"}),Object(I.jsxs)("table",{className:"table is-striped is-fullwidth",children:[Object(I.jsx)("thead",{children:Object(I.jsxs)("tr",{children:[Object(I.jsx)("th",{children:" SSID "}),Object(I.jsx)("th",{children:" SNR "})]})}),Object(I.jsx)("tbody",{children:l.map((function(e){return Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{children:e.ssid}),Object(I.jsx)("td",{children:e.snr})]})}))})]})]})})]})},H=Object(l.c)(d),M=function(){return Object(I.jsx)("div",{children:Object(I.jsx)(l.a,{store:H,children:Object(I.jsxs)(o.c,{children:[Object(I.jsx)(o.a,{path:"home",element:Object(I.jsx)(R,{})}),Object(I.jsx)(o.a,{path:"config",element:Object(I.jsx)(J,{})}),Object(I.jsx)(o.a,{path:"wifi",element:Object(I.jsx)(B,{})}),Object(I.jsx)(o.a,{path:"*",element:Object(I.jsx)(R,{})})]})})})};i.a.render(Object(I.jsx)(s.a.StrictMode,{children:Object(I.jsx)(r.a,{children:Object(I.jsx)(M,{})})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.bcb1ee27.chunk.js.map